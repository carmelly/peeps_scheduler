# ðŸ“‚ db/ â€” Database Folder

This folder contains everything related to the SQLite database used in the project, including schema definitions, migrations, and backup utilities.

---

## ðŸ“¦ Files & Structure

```
db/
â”œâ”€â”€ peeps_scheduler.db       # Your SQLite database (ignored by Git)
â”œâ”€â”€ schema.sql               # Auto-generated reference schema (do not edit manually)
â”œâ”€â”€ migrate.py               # Applies SQL migrations and updates schema.sql
â”œâ”€â”€ backup.py                # Creates and restores timestamped database backups
â”œâ”€â”€ migrations/              # Folder containing versioned schema migrations
â”‚   â”œâ”€â”€ 001_initial_schema.sql
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ backups/                 # Folder where backups are stored
â”‚   â”œâ”€â”€ 20250407-1530_backup.db
â”‚   â””â”€â”€ ...
```

---

## ðŸ” Migrations

Schema changes are managed using migration files in `db/migrations/`.

### Running Migrations

```bash
python db/migrate.py
```

- Applies any unapplied `.sql` files in order
- Tracks applied files in the `__migrations_applied__` table
- Regenerates `schema.sql` using `sqlite3.exe` from the `db/` folder

> ðŸ’¡ Tip: Download the SQLite CLI from https://sqlite.org/download.html and place `sqlite3.exe` in the `db/` folder.

---

## ðŸ§¯ Backups

Create timestamped backups and restore old database states.

### Create a Backup

```bash
python db/backup.py
```

Saves a backup like `20250407-1545_my_backup.db` in `db/backups/`.

### Restore a Backup

```bash
python db/backup.py --restore
```

Prompts you to select and restore a backup into `db/peeps_scheduler.db`.

### List Backups

```bash
python db/backup.py --list
```

---

## ðŸ§¼ .gitignore Recommendations

```gitignore
db/peeps_scheduler.db
db/backups/*.db
db/sqlite3.exe
```

---

## ðŸ§  Tips

- Keep `schema.sql` versioned, but donâ€™t edit it directly â€” it's generated by `migrate.py`
- Use backups before major changes or imports
- Each migration file should be **pure SQL**, applied exactly once
